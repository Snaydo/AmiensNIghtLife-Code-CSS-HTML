<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="icon" href="./img/favicon.ico" type="image/x-icon">
	<link rel="shortcut icon" href="./img/favicon.ico" type="image/x-icon">
	<script src="./javascript/accessibility/access.js"></script>

    <!-- Meta tags pour le référencement -->
    <meta name="description" content="Explorez la vie nocturne d'Amiens avec les meilleurs bars et boîtes de nuit. Trouvez des informations sur les établissements ouverts, des événements à venir et plus encore.">
    <meta name="keywords" content="Amiens, Night Life, bars, boîtes de nuit, vie nocturne, établissements, événements, amiens night life, anl">
    <meta name="author" content="Snaydo">

	<!-- Directives pour les moteurs de recherche -->
	<meta name="robots" content="index, follow"> <!-- Indique aux moteurs de recherche d'indexer et de suivre les liens de votre site -->
	<meta name="revisit-after" content="7 days"> <!-- Indique la fréquence à laquelle les moteurs de recherche doivent revisiter votre site -->
	<meta name="referrer" content="no-referrer"> <!-- Contrôle la politique de référence pour votre site -->
	
	<!-- Meta tags pour les médias sociaux et l'affichage mobile -->
	<meta name="image" content="./img/amiens-home.png"> <!-- Lien vers une image représentative de votre site -->
	<meta name="theme-color" content="#fe2775"> <!-- Spécifie la couleur principale de votre site pour les appareils mobiles -->
	
	 <!-- Configuration pour les appareils iOS -->
	<meta name="apple-mobile-web-app-capable" content="yes"> <!-- Permet l'installation de votre site sur l'écran d'accueil des appareils iOS -->
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"> <!-- Style de la barre d'état pour les appareils iOS -->
	<link rel="apple-touch-icon" href="./img/logo-insta.png">
	<meta name="apple-mobile-web-app-title" content="Amiens Night Life"> <!-- Définit un titre personnalisé pour l'application web sur l'écran d'accueil de l'iPhone -->
	<meta name="apple-touch-fullscreen" content="yes"> <!-- Indique que l'application web doit s'exécuter en mode plein écran sur les appareils iOS -->
	<meta name="apple-mobile-web-app-orientation" content="portrait">
	<meta name="apple-mobile-web-app-allow-popups" content="yes">
	<meta name="apple-mobile-web-app-allow-fullscreen" content="yes">

	<!-- Balises Open Graph pour les médias sociaux -->
	<meta property="og:title" content="Amiens Night Life | Snake">
	<meta property="og:description" content="Explorez la vie nocturne d'Amiens avec les meilleurs bars et boîtes de nuit. Trouvez des informations sur les établissements ouverts, des événements à venir et plus encore.">
	<meta property="og:image" content="./img/amiens-home.png">
	<meta property="og:url" content="https://amiensnightlife.fr/">
	<meta property="og:type" content="website">


	<title>Amiens Night Life | Snake</title>

	<link href="https://fonts.googleapis.com/css?family=Roboto:400,500,700,900&display=swap" rel="stylesheet">

	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3066921099143474"
	crossorigin="anonymous"></script>



	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/ionicons.min.css">
	<link rel="stylesheet" href="css/fakeLoader.css">
	<link rel="stylesheet" href="css/swiper.min.css">
	<link rel="stylesheet" href="css/style.css">

	    <!-- styles -->
		<style>
			/* CSS */
			body, html {
				overflow: hidden;
				height: 100%;
			}

			/* Define styles for the snake game */
			#gameCanvas {
				background-color: black;
				display: block;
				margin: 0 auto;
				position: relative; /* Assurez-vous que la position est relative */
				max-width: 100%; /* Pour s'assurer qu'il ne déborde pas sur les téléphones */
				max-height: calc(100vh - 100px); /* Hauteur maximale, ajustez selon vos besoins */
			}

			.control-wrapper {
				display: flex;
				justify-content: center;
				width: 100%; /* Assurez-vous que le conteneur s'étend sur toute la largeur */
			}

			.circle {
				position: relative;
				border-radius: 50%; 
				overflow: hidden;
				display: flex; /* Ajout de display flex */
				justify-content: center; /* Centrage horizontal */
				align-items: center; /* Centrage vertical */
			}

			#controlCircle {
				width: 80px;
				height: 80px;
				background-color: rgba(255, 255, 255, 0.5);
				border-radius: 50%;
			}

			#innerCircle {
				width: 20px; 
				height: 20px;
				background-color: rgba(254, 39, 117, 1);
				border-radius: 50%;
			}
		</style>

</head>
<body>

	
	<!-- PreLoader -->
	<div class="PreLoader">
		<img src="./img/logo-anl-no-bg.png" alt="Logo">
		<h2>Amiens NightLife</h2>
		<div class="loading-bar"></div>
	</div>
	<!-- end PreLoader -->
	
	<!-- navbar -->
	<div class="navbar">
		<div class="left">
			<a href="" class="link link-back"><i class="icon ion-ios-arrow-back"></i></a>
		</div>
		<div class="title">
			Snake
		</div>
		<div class="right">
			
		</div>
	</div>
	<!-- end navbar -->

	<!-- pages wrapper -->
	<div class="pages-wrapper">

		<canvas id="gameCanvas" width="400" height="400"></canvas>
		<div class="control-wrapper">
			<div id="controlCircle" class="circle">
				<div id="innerCircle" class="circle"></div>
			</div>
		</div>		


	</div>
	<!-- end pages wrapper -->

	<script src="js/jquery-3.4.1.min.js"></script>
	<script src="js/bootstrap.bundle.min.js"></script>
	<script src="js/swiper.min.js"></script>
	<script src="js/main.js"></script>

	<script src="./javascript/ui/preloader.js"></script>

	<script>
window.onload = function () {
    var canvas = document.getElementById("gameCanvas");
    var ctx = canvas.getContext("2d");

    var gridSize = 20;
    var tileCount = 20;

    var snake = [{ x: 10, y: 10 }];
    var dx = 0;
    var dy = 0;

    var reward = { x: 15, y: 15 };
    var score = 0;

	var controlWrapper = document.getElementsByClassName("control-wrapper");

    var controlCircle = document.getElementById("controlCircle");
    var innerCircle = document.getElementById("innerCircle");

    var rewardImage = new Image();
    rewardImage.src = './img/beer.png';

	var snakeColorHue = 0; // Initialisation de la teinte de la couleur du serpent

    function isMobile() {
        // Utilisez cette fonction pour déterminer si l'utilisateur est sur un appareil mobile
        return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    }

		if (isMobile()) {
		var controlWrapper = document.getElementsByClassName("control-wrapper");
			if (controlWrapper.length > 0) {
				controlWrapper[0].style.display = "flex";
			}
	} else {
		var controlWrapper = document.getElementsByClassName("control-wrapper");
		if (controlWrapper.length > 0) {
			controlWrapper[0].style.display = "none";
		}
	}


    function handleControlTouch(evt) {
        var touch = evt.touches[0];
        var touchX = touch.clientX;
        var touchY = touch.clientY;
        moveInnerCircle(touchX, touchY);
        evt.preventDefault();
    }

	function moveInnerCircle(touchX, touchY) {
		var rect = controlCircle.getBoundingClientRect();
		var centerX = rect.left + rect.width / 2 - window.scrollX;
		var centerY = rect.top + rect.height / 2 - window.scrollY;

		var dxTouch = touchX - centerX;
		var dyTouch = touchY - centerY;

		// Calcul de la direction principale basée sur le delta le plus élevé
		var direction = Math.abs(dxTouch) > Math.abs(dyTouch) ? 'horizontal' : 'vertical';

		if (direction === 'horizontal') {
			if (dx === 0) { // Changement de direction autorisé uniquement si le mouvement actuel n'est pas horizontal
				dx = dxTouch > 0 ? 1 : -1;
				dy = 0;
			}
		} else { // vertical
			if (dy === 0) { // Changement de direction autorisé uniquement si le mouvement actuel n'est pas vertical
				dx = 0;
				dy = dyTouch > 0 ? 1 : -1;
			}
		}

		// Limitation du mouvement de innerCircle à l'intérieur de controlCircle
		var distance = Math.sqrt(dxTouch * dxTouch + dyTouch * dyTouch);
		var maxDistance = rect.width / 2 - innerCircle.offsetWidth / 2;

		if (distance > maxDistance) {
			var angle = Math.atan2(dyTouch, dxTouch);
			dxTouch = Math.cos(angle) * maxDistance;
			dyTouch = Math.sin(angle) * maxDistance;
		}

		innerCircle.style.transform = `translate(${dxTouch}px, ${dyTouch}px)`;
	}

	function changeSnakeColor() {
        snakeColorHue = (snakeColorHue + 1) % 360; // Change la teinte pour créer un effet de dégradé
    }

    rewardImage.onload = function() {
        if (isMobile()) {
            controlCircle.addEventListener("touchstart", handleControlTouch, false);
            controlCircle.addEventListener("touchmove", handleControlTouch, false);
        }

        document.addEventListener("keydown", function(event) {
            switch (event.key) {
                case "ArrowUp": if (dy === 0) { dy = -1; dx = 0; } break;
                case "ArrowDown": if (dy === 0) { dy = 1; dx = 0; } break;
                case "ArrowLeft": if (dx === 0) { dx = -1; dy = 0; } break;
                case "ArrowRight": if (dx === 0) { dx = 1; dy = 0; } break;
            }
        });
    };

	function drawRoundRect(ctx, x, y, width, height, radius) {
		ctx.beginPath();
		ctx.moveTo(x + radius, y);
		ctx.lineTo(x + width - radius, y);
		ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
		ctx.lineTo(x + width, y + height - radius);
		ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
		ctx.lineTo(x + radius, y + height);
		ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
		ctx.lineTo(x, y + radius);
		ctx.quadraticCurveTo(x, y, x + radius, y);
		ctx.closePath();
		ctx.fill();
	}

	function draw() {
		ctx.clearRect(0, 0, canvas.width, canvas.height);

		var head = { x: snake[0].x + dx, y: snake[0].y + dy };
		snake.unshift(head);

		if (head.x < 0 || head.x >= tileCount || head.y < 0 || head.y >= tileCount || checkSnakeCollision()) {
			gameOver();
			return;
		}

		if (head.x === reward.x && head.y === reward.y) {
			score++;
			placeReward();
		} else {
			snake.pop();
		}

		ctx.drawImage(rewardImage, reward.x * gridSize, reward.y * gridSize, gridSize * 1.3, gridSize * 1.3);

		snake.forEach(function(segment) {
			ctx.fillStyle = 'white';
			// Modifier ici pour dessiner chaque segment avec un border radius
			drawRoundRect(ctx, segment.x * gridSize, segment.y * gridSize, gridSize, gridSize, 5); // Vous pouvez ajuster le rayon
		});

		ctx.fillStyle = 'white';
		ctx.fillText('Score: ' + score, 10, 20);
	}

    function placeReward() {
        reward.x = Math.floor(Math.random() * tileCount);
        reward.y = Math.floor(Math.random() * tileCount);
    }

    function gameOver() {
        alert("Partie terminée ! Votre score est : " + score);
        snake = [{ x: 10, y: 10 }];
        dx = 0;
        dy = 0;
        score = 0;
        placeReward();
    }

    function checkSnakeCollision() {
        for (var i = 4; i < snake.length; i++) {
            if (snake[i].x === snake[0].x && snake[i].y === snake[0].y) return true;
        }
        return false;
    }

    var gameLoop = setInterval(draw, 100);
};
	</script>
</body>
</html>